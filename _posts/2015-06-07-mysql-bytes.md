---
layout: post
title: "MySQL 字段类型大小"
author: "HaoDu"
header-style: text
tags:
  - MySQL
  - CS
---
一、首先来说下字符与字节的区别：

字符与字节它们完全不是一个位面的概念，所以两者之间没有“区别”这一说法。在不同编码里，***字符*** 和***字节***的对应关系是不同的。一般来说，半角英文状态下一个字母或数字（称之为字符）占用一个字节，一个汉字用两个字节表示。在不同的编码方式下一个字符占的字节数是不同的，所以两者是不能划等号的。

1个字节（Byte）等于8个bit位，每个bit位是0/1两种状态，也就是说一个字节可以表示2 的 8 次方，256个状态，计算机里用字节来作为最基本的存储单位。

字符，在计算机和电信技术中，一个字符是一个单位的字形、类字形单位或符号的基本信息。

字符是指计算机中使用的字母、数字、字和符号，包括：1、2、3、A、B、C、~！·#￥%……—*（）——+等等。

①ASCII码中，一个英文字母（不分大小写）占一个字节的空间，一个中文汉字占两个字节的空间。一个二进制数字序列，在计算机中作为一个数字单元，一般为8位二进制数，换算为十进制。最小值0，最大值255。

②UTF-8编码中，一个英文字符等于一个字节，一个中文（含繁体）等于三(3-4)个字节。(中国的汉字多达10多万，常用的汉字3500左右[08年统计]，如果用3个字节来表示，一共只有2^16(65535)种可能，不足以表示10多万的汉字。所以中日韩的超大字符集是采用的4个字节来表示的，多达6万多个。但是平时使用超大字符集的概率0.01%都不到。所以我们一般认为日常的中文在UTF-8中占三个字节 即可！)

③Unicode编码中，一个英文等于两个字节，一个中文（含繁体）等于两个字节。

文本符号：英文标点占一个字节，中文标点占两个字节。举例：英文句号“.”占1个字节的大小，中文句号“。”占2个字节的大小。

④UTF-16编码中，一个英文字母字符或一个汉字字符存储都需要2个字节（Unicode扩展区的一些汉字存储需要4个字节）。

⑤UTF-32编码中，世界上任何字符的存储都需要4个字节。

二、varchar和char 的区别：

　　char是一种固定长度的类型，varchar则是一种可变长度的类型，它们的区别是： char(M)类型的数据列里，每个值都占用M个字节，如果某个长度小于M，MySQL就会在它的右边用空格字符补足．（在检索操作中那些填补出来的空格字符将被去掉）在varchar(M)类型的数据列里，每个值只占用刚好够用的字节再加上一个用来记录其长度的字节（即总长度为L+1字节）．

　　在MySQL中用来判断是否需要进行对据列类型转换的规则

　　1、在一个数据表里，如果每一个数据列的长度都是固定的，那么每一个数据行的长度也将是固定的．

　　2、只要数据表里有一个数据列的长度的可变的，那么各数据行的长度都是可变的．

　　3、如果某个数据表里的数据行的长度是可变的，那么，为了节约存储空间，MySQL会把这个数据表里的固定长度类型的数据列转换为相应的可变长度类型．例外：长度小于4个字符的char数据列不会被转换varchar类型

在mysql中,char和varchar都表示字符串类型.但他们存储和检索数据的方式并不相同.

在表结构定义中声明char和varchar类型时,必须指定字符串的长度.也就是该列所能存储多少个字符（不是字节,是字符）.例如：char(10)和varchar(10)都能存储10个字符.

声明为char的列长度是固定的,char的长度可选范围在0-255之间.也就是char最大能存储255个字符.如果该列是utf8编码,则该列所占用的字节数=字符数*3.如果是gbk编码则该列所占用的字节数=字符数*2.

声明为varchar的列长度是可变的,在mysql5.0.3之前varchar的长度范围为0-255,mysql5.0.3之后varchar的长度范围为0-65535个字节.采用varchar类型存储数据需要1-2个字节(长度超过255时需要2个字节)来存储字符串的实际长度.如果该列的编码为gbk,每个字符最多占用2个字节,最大长度不能超过32766个字符.如果该列的编码为utf8,每个字符最多占3个字节,最大字符长度为21845.

总结:

 ① char和varchar最大的不同就是一个是固定长度,一个是可变长度.由于是可变长度,因此存储的是实际字符串再加上一个记录字符串长度的字节。如果分配给char或varchar列的值超过 列的最大长度,则对值进行裁剪.

 ②varchar(M)和char(M),M都表示字符数.varchar的最大长度为65535个字节,不同的编码所对应的最大可存储的字符数不同.char最多可以存放255个字符,不同的编码最大可用字节数不同.

length()与char_length()

length():Return the length of a string in bytes.返回字符串所占的字节数(受编码影响).

char_length():Return number of characters in argument.返回字符串中的字符数.

 

test:

1.建表

create table t_char_test(
id int(11) primary key,
name_char char(10) ,
name_varchar varchar(10) 
)engine=Myisam default charset=utf8;

insert into t_char_test(id,name_char,name_varchar) values (0,'字符类型','字符类型');

结果集如下：



 

3、varchar最大长度是多少？

varchar存储规则：

　　4.0版本以下，varchar(20)，指的是20字节，如果存放UTF8汉字时，只能存6个（每个汉字3字节）
5.0版本以上，varchar(20)，指的是20字符，无论存放的是数字、字母还是UTF8汉字（每个汉字3字节），都可以存放20个，最大大小是65532字节 
Mysql4中最大也不过是20个字节,但是Mysql5根据编码不同,存储大小也不同。

　　这不是一个固定的数字。先简要说明一下限制规则。

　　1、限制规则

　　字段的限制在字段定义的时候有以下规则：

　　a) 存储限制

　　varchar 字段是将实际内容单独存储在聚簇索引之外，内容开头用1到2个字节表示实际长度（长度超过255时需要2个字节），因此最大长度不能超过65535。

　　b) 编码长度限制

　　字符类型若为gbk，每个字符最多占2个字节，最大长度不能超过32766;

　　字符类型若为utf8，每个字符最多占3个字节，最大长度不能超过21845。

　　若定义的时候超过上述限制，则varchar字段会被强行转为text类型，并产生warning。

　　c) 行长度限制

　　导致实际应用中varchar长度限制的是一个行定义的长度。 MySQL要求一个行的定义长度不能超过65535。若定义的表长度超过这个值，则提示

　　ERROR 1118 (42000): Row size too large. The maximum row size for the used table type, not counting BLOBs, is 65535. You have to change some columns to TEXT or BLOBs。

　　2、计算例子

　　举两个例说明一下实际长度的计算。

　　a) 若一个表只有一个varchar类型，如定义为

　　create table t4(c varchar(N)) charset=gbk;

　　则此处N的最大值为(65535-1-2)/2= 32766。

　　减1的原因是实际行存储从第二个字节开始’;

　　减2的原因是varchar头部的2个字节表示长度;

　　除2的原因是字符编码是gbk。

　　b) 若一个表定义为

　　create table t4(c int, c2 char(30), c3 varchar(N)) charset=utf8;

　　则此处N的最大值为 (65535-1-2-4-30*3)/3=21812

　　减1和减2与上例相同;

　　减4的原因是int类型的c占4个字节;

　　减30*3的原因是char(30)占用90个字节，编码是utf8。

　　如果被varchar超过上述的b规则，被强转成text类型，则每个字段占用定义长度为11字节，当然这已经不是“varchar”了。

　　则此处N的最大值为 (65535-1-2-4-30*3)/3=21812

　　create table t4(c int, c2 char(30), c3 varchar(21812)) ENGINE=InnoDB DEFAULT CHARSET=utf8

　　create table t5(c int, c2 varchar(30), c3 varchar(21812)) ENGINE=InnoDB DEFAULT CHARSET=utf8

　　varchar(30)和char(30)最多能存放：

　　工在基工左基工在基顺工作奔大规模集成电路城工作东奔西走左夺工城鞯革城载模压地工魂牵梦萦栽土木工程魂牵梦萦栽植奇巧魂牵梦萦地厅城柑模压东奔西走苦村落模压革革柑可耕地村模压基栽魂牵梦基

　　aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

　　aaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaa

　　111111111111111111111111111111111111111111111111111111

　　111111111111111111111111111111111111

http://www.educity.cn/wenda/596225.html

类型|大小|范围（有符号）|范围（无符号）
---|---|---|---
TINYINT|1 byte|（-128，127）|（0，255）
INT|4 bytes|(-2 147 483 648，2 147 483 647)|	(0，4 294 967 295)
BIGINT|8 bytes

